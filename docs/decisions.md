# Decisions LogThis document captures decisions that materially affect architecture, storage, ingestion, or UX. It is meant to be stable and easy to reference later.See also:- `docs/checklist.md` for phase sequencing and deliverables- `docs/time_rules.md` for canonical time/session/bucketing rules---## Stack- Backend: FastAPI- Rendering: server-side templates + htmx (partial updates)- Charts: Plotly (library, not Dash)---## Storage- Database: SQLite (v1)- Bar storage model:  - `bars_1m` is canonical (1-minute bars)  - `bars_30m` is derived (30-minute bars computed from `bars_1m`)- Bars are stored in separate tables (not a unified table).---## Time handling- Store bar start instants as `ts_start_utc` (epoch seconds INTEGER).- Import timestamps are interpreted in a selectable `input_timezone`:  - default: `America/Chicago` (CT)- Store CT helper fields for analytics and session logic:  - `trading_date_ct_int` (YYYYMMDD integer, CT 17:00 rollover)  - `ct_minute_of_day` (0..1439 integer)- Session boundaries (CT):  - ON: 17:00:00–08:29:59  - RTH: 08:30:00–15:59:59- RTH includes the 15:30–16:00 30m bucket.- 16:00:00–16:59:59 CT is out-of-session for v1 unless a specific report requires it.---## Ingestion- Public uploads are not supported.- Ingestion is admin/server-side only.- v1 ingestion interface is CLI-only; an admin web page is deferred.- Merge policy:  - `skip` existing bars  - `overwrite` existing bars (upsert)---## Derived data and period identity- Derived 30m bars include:  - `period_index` (integer, authoritative for period math)  - optional `tpo` label for display (must support >1 char; ON spans 30 periods)- Derived bars are treated as a cache and are rebuilt deterministically from canonical data (no row-level trigger aggregation).---## Repository approach- Use “loaded repositories”:  - SQL statements live in `.sql` files  - Python repository modules load SQL, bind parameters, execute, and map results  - Business logic lives in services/domain modules, not in repositories---## Deployment direction- Local-first development.- Docker-based workflow to keep local and VPS deployment near-identical.- Hosting target later: low-cost VPS (<= $5/month), but hosting is not required for early phases.---## Deferred / not decided yet- Exact definition(s) of “breach” for rolling breach analytics (up/down/either; strict vs touch).- Holiday/early-close handling (if required for v1).- Whether to persist `tpo` in the database or derive it at query/render time.